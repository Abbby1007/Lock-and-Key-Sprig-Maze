

// Made for the arcade session
// is a remix of the maze game start by Cher Berhanu

// Finished on July 9th, 2024 


const player = "p"// player

//variables for Keys
const yellowKey = "y" // yellow key
const blueKey = "b" // Blue Key
const greenKey = "g" // Green Key

// Variables for the locks
const greenLock = "h" // greenlock
const yellowLock = "j" // Yellow lock
const blueLock = "k" // Blue Lock

//varibles for enviroment
const wall = "w" // concrete wall

let number = 0;

const melody = tune `
500: A5-500 + C4~500,
500: C4^500,
500: D5-500 + C4^500,
500: C4^500,
500: G5-500 + C4~500,
500: C4^500,
500: C5-500 + C4^500,
500: C4^500,
500: F5-500 + C4~500,
500: C4^500,
500: A5-500 + C4^500,
500: C4^500,
500: G5-500 + C4~500,
500: C4^500,
500: C5-500 + C4^500,
500: A5-500 + C4~500,
500: C4^500,
500: C4^500 + D5-500,
500: C4^500,
500: C4~500 + G5-500,
500: C4^500,
500: C4^500 + C5-500,
500: C4^500,
500: C4~500 + F5-500,
500: C4^500,
500: C4^500 + A5-500,
500: C4^500,
500: C4~500 + G5-500,
500: C4^500,
500: C4^500 + C5-500,
500: C4~500,
500: C4^500`;

playTune(melody, Infinity);

setLegend(
  [player, bitmap`
................
....66666666....
...6666666666...
..666666666666..
.66600666600666.
.66600666600666.
.66600666600666.
.66600666600666.
.66666666666666.
.60066666666666.
.66006666660066.
.66600666660666.
..666600060066..
...6666600066...
....66666666....
................`], // player
  [yellowKey, bitmap`
................
................
................
................
.66666..........
6666666.........
6622266666666666
662226666.6.6.66
66222666.6.6.6..
6666666.........
.66666..........
................
................
................
................
................`], // yellow key
  [yellowLock, bitmap`
................
................
................
......6666......
.....666666.....
....66....66....
....6......6....
....6......6....
....6......6....
....66666666....
....66666666....
....66111166....
....66111166....
....66611666....
....66611666....
....66666666....`], // yellow lock
   [greenLock, bitmap`
................
................
................
......4444......
.....444444.....
....44....44....
....4......4....
....4......4....
....4......4....
....44444444....
....44444444....
....44111144....
....44111144....
....44411444....
....44411444....
....44444444....`], // green lock
  [greenKey, bitmap`
................
................
................
................
.44444..........
4444444.........
4422244444444444
442224444.4.4.44
44222444.4.4.4..
4444444.........
.44444..........
................
................
................
................
................`], // green key
     [blueLock, bitmap`
................
................
................
......5555......
.....555555.....
....55....55....
....5......5....
....5......5....
....5......5....
....55555555....
....55555555....
....55111155....
....55111155....
....55511555....
....55511555....
....55555555....`], // blue lock
  [blueKey, bitmap`
................
................
................
................
.55555..........
5555555.........
5522255555555555
552225555.5.5.55
55222555.5.5.5..
5555555.........
.55555..........
................
................
................
................
................`], // blue key
  [wall, bitmap`
0000000000000000
LLLLLL00111110LL
LLLLLL00111110LL
0000000000000000
11110LLLLL011110
11110LLLLL011110
0000000000000000
LLLLLL0111110LL0
LLLLLL0111110LL0
0000000000000000
111110LLLL011110
111110LLLL011110
0000000000000000
LLLL01111110LLL0
LLLL01111110LLL0
0000000000000000`], // concrete wall

)

setSolids([player, wall, yellowKey])

let level = 0
const levels = [
  map`
....
py.j`, // level 1
  map `
...w...
.w.w.w.
.w.w.wg
pw...ww`, // level 2
  map `
.....w...
..w.pwww.
www......
...www...
.w.....ww
ww...w...
...www.ww
.ww.w....
...g..ww.`, // level 3
  map `
....p....
.wwwwwww.
...w...w.
wwww.w...
.....w...
..wwwwww.
.w.....w.
.w.ww..w.
...w.g.w.`, // level 4
  map `
.w.....ww..
.ww.www..w.
.......w.w.
www......ww
..www.www.w
p.....w....
.wwwwww...g
..w....ww..
.......w..w
w.wwww.w..w
w...w..w.w.
w...w..w.w.
www..ww..ww
...w.......`, // level 5
  map `
......p.....w
..w...w.ww...
..ww..w.w..ww
...wwwwwww...
ww..w.w......
..w...w..wwww
wwwww.w......
....w.ww.w.w.
.w.....www...
wwwwww.w.w..w
.w.....w.w.w.
....wwww...w.
w.....w..w.w.
.w.w..wwww...
..www.gw.....`, // level 6
  map `
.w.p.www..w..w.
.w.....wwww.ww.
.......w.......
.wwww..w.wwww..
.w.....w.w.....
.w..wwww.w.w.w.
.w.......w...w.
.wwwwwwwwwww.w.
..w..........w.
..w.w....www.w.
..w.wwww...w.w.
.......ww..www.
wwww....ww.....
...www...www...
........g..w...`, // level 7 
  map `
wp................
w.wwwwwwwwwwwwwww.
w.w.....w.........
....wwwwwwwwwww.w.
..........w.....w.
wwwwwwwww.w.wwwww.
..........w.w.....
..wwwwwww.w.w.wwww
..w...w.w.w...w...
..ww..w.www...w.w.
...w....w....ww.w.
.www..w.w.w.....ww
...w.w..w.www.....
.....w..w...wwww..
..wwww..wwwww..w..
..w.........w..g..`, // level 8 
  map `
w...............
wwwwww..wwwwwww.
p...........w.ww
...www......w...
ww...wwwww..w...
w..w.w...w.ww..g
w..www.www...w..
w...w..w.....w.w
w.w.w....w...w..
www.w..w.ww....w
.w..w..w...ww.w.
.w..wwwwww....w.
.ww.....w.ww.ww.
..ww..www.....w.
....w.w.w..www..
....w.......w...`, // level 9 
  map `
.www......w......
.w.www....w....w.
..ww..ww....www.w
p..w...w...w..w.w
.....w.w......w..
wwww.w..w...wwww.
..........ww.....
.www.wwww..w..w..
.w......ww..w.w..
.w..w.w..wwww.w..
.wwww.w...ww...ww
.w...........w...
.w.....www...w...
..wwwwww.w..ww..w
............ww.ww
.ww.wwww....ww.w.
www......wwwwwgw.`, // level 10 



]

setMap(levels[level])


setPushables({
  [player]: [yellowKey, player]
})

onInput("s", () => {
  getFirst(player).y += 1 // move down
});

onInput("w", () => {
  getFirst(player).y -= 1 // move up
});

onInput("d", () => {
  getFirst(player).x += 1 // move right
});

onInput("a", () => {
  getFirst(player).x -= 1 // move left
});

onInput("j", () => {
  setMap(levels[level])
});





// these get run after every input
afterInput(() => {
  const numberOfGoalsCovered = tilesWith(yellowKey, yellowLock ); // tiles that both contain the player and goal

  // if at least one goal is overlapping with a player, proceed to the next level
  if (numberOfGoalsCovered.length >= 1) {
    // increase the current level number

    level = level + 1;

    // check if current level number is valid
    if (level < levels.length) {
      setMap(levels[level]);
    } else {
      addText("you win!", {
        y: 6,
        color: color`6`
      });
    }
  }
});